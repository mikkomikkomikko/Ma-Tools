// Proportional Scale.jsx// Version 1.0// Copyright 2016 Mikko Aaltonen// Tell you scale factor for scaling group of objects to specific dimensions..#target illustratorif (app.documents.length > 0) {    var script_name = "Proportional Scale"var doc = app.activeDocument;var Sel = doc.selection;var newValue;var noSelection = false;//get bound of the selectionif (Sel.length >0 ) {      var vBounds = Sel[0].visibleBounds;      vBounds_Li = vBounds[0];      vBounds_Ob = vBounds[1];      vBounds_Re = vBounds[2];      vBounds_Un = vBounds[3];        if (Sel.length >1 ) {        for (i=1; i<Sel.length ; i++) {          vBdsI = Sel[i].visibleBounds;          if( vBounds_Li > vBdsI[0] ) {vBounds_Li = vBdsI[0]};          if( vBounds_Ob < vBdsI[1] ) {vBounds_Ob = vBdsI[1]};          if( vBounds_Re < vBdsI[2] ) {vBounds_Re = vBdsI[2]};          if( vBounds_Un > vBdsI[3] ) {vBounds_Un = vBdsI[3]};          }      }  } else {    alert("You do not have any object selected!");    noSelection = true;    }var selectionWidth = vBounds_Re - vBounds_Li - 1;//The magic functionfunction doMagic() {        if  (newValue <= 1) {               magicValue =1;         }else {             magicValue = (100 / selectionWidth) * newValue;        //$.writeln(selectionWidth);              }    }// GUIstartGUI();function startGUI() {    if (noSelection == true)  {         return;        } else {                            // Create Main Window    var win = new Window( "dialog", script_name, undefined );        // Style for Main Window    win.orientation = "column";    win.alignChildren = ["fill", "fill"];    //win.preferredSize = [150, 350];        // Style for newValue group    var newValueGrp = win.add("panel", undefined, "Proportional Scale");    newValueGrp.orientation = "column";    newValueGrp.alignChildren = ["fill", "fill"];        var titleMsg = newValueGrp.add ("statictext", undefined, "Enter new width in pixels");    var inputText = newValueGrp.add("edittext { characters: 1, justify: 'center', active: true }");    inputText.helpTip = "Enter new width in pixels";    // Search Button    var magicBtn = newValueGrp.add("button", undefined, "Calculate");    magicBtn.helpTip = "Get the magic number";    magicBtn.onClick = function() {                doMagic();                //$.writeln(magicValue);                 win.close();                alert("Scale value is: " + magicValue);                app.redraw();    }        // Listener for the input    inputText.onChanging = function() {        newValue = inputText.text;        app.redraw();    }    // Close button    var quitBtn = win.add("button", undefined, "Close");    quitBtn.helpTip = "Press Esc to Close";    // Event listener for the quit button    quitBtn.onClick = function() {           win.close();       }      // Centering & Show Window    win.center();    win.show(); }}} else {    alert("You do not have any document opened!");}